import matplotlib.pyplot as plt
from distance_wasserstein_pot import *
from utils import *

down_factor = 32
scaling_parameter_c = 4

img = plt.imread('cat_images/A.jpg')
img_A = np.array(img)
img_A = downsample_image(img_A, down_factor)

img = plt.imread('cat_images/B.jpg')
img_B = np.array(img)
img_B = downsample_image(img_B, down_factor)

img = plt.imread('cat_images/D.jpg')
img_D = np.array(img)
img_D = downsample_image(img_D, down_factor)

for scaling_parameter_c in [4, 8, 16, 32, 64, 128, 256, 512]:
    print("################################SHAPE################################")
    print(img_A.shape)


    print("################################SCALING FACTOR################################")
    print(scaling_parameter_c)

    print("################### Wasser Distance Between AB #########################")
    dist_AB, _ = calculate_wasserstein_distance_between_images(img_A, img_B, scaling_parameter_c)
    print(dist_AB)
    print("########################################################################")


    print("################### Wasser Distance Between AD #########################")
    dist_AD, _ = calculate_wasserstein_distance_between_images(img_A, img_D, scaling_parameter_c)
    print(dist_AD)
    print("########################################################################")



# /opt/anaconda3/envs/MyProject1/bin/python /Users/chuanlin/JHU-LAB/MyCOT/see_scaling_effect.py
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 4
# ################### Wasser Distance Between AB #########################
# 1.2286064300254982
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 0.4281059656616384
# ########################################################################
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 8
# ################### Wasser Distance Between AB #########################
# 1.2679249830801482
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 0.4378416161215268
# ########################################################################
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 16
# ################### Wasser Distance Between AB #########################
# 1.3465620891894565
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 0.45662413613791103
# ########################################################################
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 32
# ################### Wasser Distance Between AB #########################
# 1.5038363014080578
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 0.49300844723921267
# ########################################################################
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 64
# ################### Wasser Distance Between AB #########################
# 1.8183847258452688
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 0.5654789947856507
# ########################################################################
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 128
# ################### Wasser Distance Between AB #########################
# 2.447481574719718
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 0.7104200898785274
# ########################################################################
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 256
# ################### Wasser Distance Between AB #########################
# 3.7056752724685804
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 1.0003022800642825
# ########################################################################
# ################################SHAPE################################
# (32, 32, 3)
# ################################SCALING FACTOR################################
# 512
# ################### Wasser Distance Between AB #########################
# 6.222062667966301
# ########################################################################
# ################### Wasser Distance Between AD #########################
# 1.580066660435797
# ########################################################################
#
# Process finished with exit code 0
